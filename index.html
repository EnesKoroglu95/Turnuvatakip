<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Turnuva Takip</title>

<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: #f4f4f4;
}

/* ÜST BAR */
.header {
    background: #c40000;
    padding: 10px;
    text-align: center;
}
.header span {
    background: #0b4dbb;
    color: white;
    padding: 6px 20px;
    border-radius: 6px;
    font-weight: bold;
}

/* ARAMA */
.search {
    margin: 20px;
    text-align: center;
}
.search input {
    padding: 6px;
    width: 250px;
}
.search button {
    padding: 6px 15px;
    cursor: pointer;
}

/* TABLO */
table {
    border-collapse: collapse;
    margin: 20px auto;
    width: 95%;
    background: white;
    table-layout: fixed;
}

th, td {
    border: 1px solid black;
    padding: 6px;
    font-size: 13px;
    text-align: center;
    word-wrap: break-word;
}

th {
    background: #e3f0ff;
}

/* ZEBRA */
tbody tr:nth-child(odd) {
    background: #eaffea;
}

/* SÜTUN GENİŞLİKLERİ */
.col-player { width: 220px; text-align: left; }
.col-small  { width: 80px; }

/* GİZLE */
.hidden {
    display: none;
}
</style>
</head>

<body>

<div class="header">
    <span>TURNUVA TAKİP</span>
</div>

<div class="search">
    Oyuncu Ara:
    <input type="text" id="playerInput" placeholder="Oyuncu Adı Soyadı">
    <button onclick="searchPlayer()">Bul</button>
</div>

<table id="resultTable" class="hidden">
<thead>
<tr>
    <th class="col-player">Karşılaşmalar</th>
    <th class="col-small">Skor</th>
    <th class="col-small">MP</th>
    <th class="col-small">Alınan</th>
    <th class="col-small">Gereken</th>
    <th class="col-small">Averaj</th>
    <th class="col-small">EYS1</th>
    <th class="col-small">EYS2</th>
</tr>
</thead>
<tbody id="tableBody"></tbody>
</table>

<script>
const CSV_URL =
"https://docs.google.com/spreadsheets/d/e/2PACX-1vQ359o8xV7eUC94-244P9_A83mf5-iSYA7HNQq9sNyvk-w1iP8dCVokASwjLRaFBL-t0Hkf1wxFuq9u/pub?output=csv";

let rows = [];

fetch(CSV_URL)
.then(r => r.text())
.then(text => {
    rows = text.split("\n").map(r => r.split(","));
});

function searchPlayer() {
    const name = document.getElementById("playerInput").value.trim().toUpperCase();
    if (!name) return;

    let foundGroup = null;
    let startIndex = -1;

    for (let i = 0; i < rows.length; i++) {
        if (rows[i][0]?.startsWith("G")) {
            for (let j = i + 1; j < i + 30 && j < rows.length; j++) {
                if (rows[j][1]?.toUpperCase().includes(name)) {
                    foundGroup = rows[i][0];
                    startIndex = i;
                    break;
                }
            }
        }
        if (foundGroup) break;
    }

    if (!foundGroup) {
        alert("Oyuncu bulunamadı");
        return;
    }

    renderGroup(startIndex);
}

function renderGroup(start) {
    const body = document.getElementById("tableBody");
    body.innerHTML = "";

    for (let i = start + 1; i < start + 22 && i < rows.length; i++) {
        if (rows[i][0]?.startsWith("Sporcular")) break;

        const tr = document.createElement("tr");
        for (let c = 1; c <= 8; c++) {
            const td = document.createElement("td");
            td.textContent = rows[i][c] || "";
            tr.appendChild(td);
        }
        body.appendChild(tr);
    }

    document.getElementById("resultTable").classList.remove("hidden");
}
</script>

</body>
</html>
